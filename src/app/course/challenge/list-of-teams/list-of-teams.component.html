<section class="tui-container tui-container_adaptive ng-star-inserted">
    <div class="flex flex-wrap gap-3 tui-space_top-6">
        <h3 class="tui-text_h3 tui-col_stretch flex-grow">List of Teams</h3>
        <a
            [disabled]="event.is_open || event.is_closed"
            [routerLink]="['create']"
            icon="tuiIconPlus"
            appearance="primary"
            aria-label="Create a New Team"
            size="m"
            tuiButton
        >
            Create a New Team
        </a>
    </div>
    <ng-container *ngIf="teams else skeletonTemplate">
        <ng-container *ngFor="let team of teams; let index = index">
            <ng-container *ngIf="team">
                <tui-accordion class="tui-space_top-6">
                    <tui-accordion-item>
                        <div class="flex flex-wrap gap-3">
                            <div class="min-w-[2rem]">
                                <span class="mr-1">
                                    {{index + 1}}
                                </span>
                                <tui-svg
                                    src="tuiIconUser"
                                    *ngIf="isInTeam(team)"
                                ></tui-svg>
                            </div>
                            <div class="flex-grow">{{team.name}}</div>
                            <div>
                                <tui-svg *ngIf="team.is_private" src="tuiIconLock"></tui-svg>
                            </div>
                            <div>{{team.member_names.length}} out of {{event.max_team_size}}
                                students
                            </div>
                        </div>
                        <ng-template tuiAccordionItemContent>
                            <div class="flex flex-wrap gap-3">
                                <div class="flex-grow">
                                    <div
                                        *ngFor="let name of team.member_names"
                                        class="tui-text_body-l"
                                    >
                                        {{name}}
                                    </div>
                                </div>
                                <ng-container *ngIf="isInTeam(team); else notInTeam;">
                                    <a
                                        [disabled]="event.is_open || event.is_closed"
                                        [routerLink]="[team.id, 'edit']"
                                        appearance="secondary"
                                        aria-label="Edit"
                                        size="m"
                                        tuiButton
                                        class="w-fit"
                                    >
                                        Edit
                                    </a>
                                </ng-container>
                                <ng-template #notInTeam>
                                    <button
                                        [disabled]="event.is_open || event.is_closed"
                                        (click)="joinTeam(team.id)"
                                        appearance="secondary"
                                        aria-label="Join"
                                        size="m"
                                        tuiButton
                                        class="w-fit"
                                    >
                                        Join
                                    </button>
                                </ng-template>
                            </div>
                        </ng-template>
                    </tui-accordion-item>
                </tui-accordion>
            </ng-container>

        </ng-container>
    </ng-container>
    <ng-template #skeletonTemplate>
        <tui-accordion class="accordionContainer tui-space_top-6">
            <tui-accordion-item>
                <div class="accordionHeader">
                    <div class="tui-skeleton">1</div>
                    <div class="tui-skeleton">Team Name</div>
                    <div class="tui-skeleton">Number of Students</div>
                    <div class="tui-skeleton">Private Team</div>
                </div>
            </tui-accordion-item>
        </tui-accordion>
    </ng-template>


</section>
