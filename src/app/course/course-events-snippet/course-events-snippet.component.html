<div class="eventPage">
    <div class="filters">
        <button *ngIf="showAssignment" (click)="toggleFilterAssignments()" appearance="accent" class="tui-form__button" size="m" tuiButton>
            Assignments
        </button>
        <button *ngIf="!showAssignment" (click)="toggleFilterAssignments()" appearance="outline" class="tui-form__button" size="m" tuiButton>
            Assignments
        </button>
        <button *ngIf="showExam" (click)="toggleFilterExams()" appearance="accent" class="tui-form__button" size="m" tuiButton>
            Exams
        </button>
        <button *ngIf="!showExam" (click)="toggleFilterExams()" appearance="outline" class="tui-form__button" size="m" tuiButton>
            Exams
        </button>
    </div>

    <tui-accordion class="accordionContainer" [closeOthers]="false">
        <tui-accordion-item class="title" open="true" [disableHover]="true">
            Upcoming Events
            <ng-template tuiAccordionItemContent>
                <div *ngFor="let event of upcomingEvents" class="eventList">
                    <div class="eventType">
                        <ng-container *ngIf="event.type === 'ASSIGNMENT'" >Assignment</ng-container>
                        <ng-container *ngIf="event.type === 'EXAM'" >Exam</ng-container>
                    </div>
                    <div class="name">{{ event.name }}</div>
                    <div class="dates">
                        <div>From: {{ event.start_date | date: 'EEEE, MMM d, y, h:mm a' }}</div>
                        <div>Until: {{ event.end_date | date: 'EEEE, MMM d, y, h:mm a' }}</div>
                    </div>
                    <div class="availability">
                        <tui-tag *ngIf="event.is_open; else eventComingSoon" size="m" status="success" value="Available"></tui-tag>
                        <ng-template #eventComingSoon>
                            <tui-tag size="m" status="error" value="Coming Soon"></tui-tag>
                        </ng-template>
                    </div>
                    <div class="grade">
                        <ng-container *ngIf="event.is_not_available_yet || event.is_exam; else totalEventGrade">
                            Grade: TBA
                        </ng-container>
                        <ng-template #totalEventGrade>
                            Grade: {{ event.total_event_grade | number: '1.0-1' || 'TBA'}}%
                        </ng-template>
                    </div>
                    <div class="linkBtn">
                        <ng-container *ngIf="event.is_allowed_to_open || user?.is_teacher; else notAllowedOpen">
                            <a [routerLink]="['/course', courseId, 'event', event.id]" appearance="primary" class="tui-form__button"
                               size="s"
                               tuiButton
                            >
                                {{ user.is_teacher ? 'View' : 'Complete' }}
                            </a>
                        </ng-container>
                        <ng-template #notAllowedOpen>
                            <a [disabled]="true" appearance="primary" aria-label="Complete" class="tui-form__button" href=""
                               size="s"
                               tuiButton>
                                Complete
                            </a>
                        </ng-template>
                        <a *ngIf="event.has_edit_permission" [routerLink]="['/course', courseId, 'new-event', event.id]"
                           appearance="primary" aria-label="Edit" class="tui-form__button"
                           size="s"
                           tuiButton
                        >
                            Edit
                        </a>
                    </div>
                </div>
            </ng-template>
        </tui-accordion-item>
        <tui-accordion-item open="true">
            Past Events
            <ng-template tuiAccordionItemContent>
                <div *ngFor="let event of pastEvents" class="eventList">
                    <div class="eventType">
                        <ng-container *ngIf="event.type === 'ASSIGNMENT'" >Assignment</ng-container>
                        <ng-container *ngIf="event.type === 'EXAM'" >Exam</ng-container>
                    </div>
                    <div class="name">{{ event.name }}</div>

                    <div class="dates">
                        <div>From: {{ event.start_date | date: 'EEEE, MMM d, y, h:mm a' }}</div>
                        <div>Until: {{ event.end_date | date: 'EEEE, MMM d, y, h:mm a' }}</div>
                    </div>
                    <div class="availability">
                        <tui-tag size="m" status="default" value="Closed"></tui-tag>
                    </div>
                    <div class="grade">
                        Grade: {{ event.total_event_grade | number: '1.0-1' || 'No Grade'}}%
                    </div>
                    <div class="linkBtn">
                        <ng-container *ngIf="event.is_allowed_to_open || user?.is_teacher; else notAllowedOpen">
                            <a [routerLink]="['/course', courseId, 'event', event.id]" appearance="primary" class="tui-form__button"
                               size="s"
                               tuiButton
                            >
                                {{ user.is_teacher ? 'View' : 'Complete' }}
                            </a>
                        </ng-container>
                        <ng-template #notAllowedOpen>
                            <a [disabled]="true" appearance="primary" aria-label="Complete" class="tui-form__button" href=""
                               size="s"
                               tuiButton>
                                Complete
                            </a>
                        </ng-template>
                        <a *ngIf="event.has_edit_permission" [routerLink]="['/course', courseId, 'new-event', event.id]"
                           appearance="primary" aria-label="Edit" class="tui-form__button"
                           size="s"
                           tuiButton
                        >
                            Edit
                        </a>
                    </div>
                </div>
            </ng-template>
        </tui-accordion-item>
    </tui-accordion>
</div>
