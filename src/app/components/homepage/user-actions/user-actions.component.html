<div class="tui-container tui-container_fullwidth">
    <h1 class="tui-text_h3 tui-space_vertical-10">Actions</h1>
    <tui-loader [overlay]="true" [showLoader]="!userActions || loadingTable">
        <table
                tuiTable
                [columns]="userActionsTableColumns"
                [(sorter)]="sorter"
                (sorterChange)="update()"
                [(direction)]="sortDirection"
                (directionChange)="update()"
                class="user-actions-table"
        >
            <thead tuiThead>
            <tr tuiThGroup>
                <th tuiTh [sorter]="sorters.id" *tuiHead="'id'">#</th>
                <th tuiTh [sorter]="null" *tuiHead="'description'">Description</th>
                <th tuiTh [sorter]="sorters.object_type" *tuiHead="'object_type'">Type</th>
                <th tuiTh [sorter]="sorters.status" *tuiHead="'status'">Status</th>
                <th tuiTh [sorter]="sorters.time_created" *tuiHead="'time_created'">Date</th>
                <th tuiTh [sorter]="sorters.verb" *tuiHead="'verb'">Action</th>
                <th tuiTh [sorter]="null" *tuiHead="'token_change'">Tokens</th>
            </tr>
            </thead>
            <tbody tuiTbody [data]="userActions">
            <tr tuiTr *tuiRow="let action of userActions">
                <td tuiTd *tuiCell="'description'">
                    <ng-container
                            *ngIf="action.object_type === 'Question' || action.object_type === 'Submission' && action.description; else notALinkAction">
                        <ng-container *ngIf="action.object_type === 'Question'">
                            <a tuiLink routerLink="/problems/{{action.object_id}}" [innerHTML]="action.description"></a>
                        </ng-container>
                        <ng-container *ngIf="action.object_type === 'Submission'">
                            <a tuiLink routerLink="/problems/submission/{{action.object_id}}"
                               [innerHTML]="action.description"></a>
                        </ng-container>
                    </ng-container>
                    <ng-template #notALinkAction>
                        {{ (action.description) || 'No Description' }}
                    </ng-template>
                </td>
                <td tuiTd *tuiCell="'object_type'">
                    {{ (action.object_type) || 'No Type' }}
                </td>
                <td tuiTd *tuiCell="'status'">
                    {{ (action.status) || 'No Status' }}
                </td>
                <td tuiTd *tuiCell="'time_created'">
                    {{ (action.time_created | date: 'long') || 'No Date' }}
                </td>
                <td tuiTd *tuiCell="'verb'">
                    {{ (action.verb) || 'No Action' }}
                </td>
                <td tuiTd *tuiCell="'token_change'">
                    {{ action.token_change > 0 ? '+' : '' }}{{ (action.token_change | number: "1.0-2") || '0' }}
                </td>
            </tr>
            </tbody>
            <tfoot>
            <tr>
                <td [colSpan]="userActionsTableColumns.length">
                    <tui-table-pagination
                            class="tui-space_top-2"
                            [total]="numberOfActions"
                            [(size)]="pageSize"
                            [(page)]="page"
                            (pageChange)="update()"
                            (sizeChange)="update()"
                    ></tui-table-pagination>
                </td>
            </tr>
            </tfoot>
        </table>
    </tui-loader>
</div>
